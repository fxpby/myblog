"use strict";(self.webpackChunkmy_website_2=self.webpackChunkmy_website_2||[]).push([[2124],{28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var s=t(96540);const r={},a=s.createContext(r);function c(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(a.Provider,{value:n},e.children)}},70464:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"coding/design-pattern/observer-pattern-basics","title":"\u89c2\u5bdf\u8005\u6a21\u5f0f Observer Pattern","description":"\u4ecb\u7ecd","source":"@site/docs/coding/design-pattern/observer-pattern-basics.md","sourceDirName":"coding/design-pattern","slug":"/coding/design-pattern/observer-pattern-basics","permalink":"/myblog/docs/coding/design-pattern/observer-pattern-basics","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/coding/design-pattern/observer-pattern-basics.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u5907\u5fd8\u5f55\u6a21\u5f0f Memento Pattern","permalink":"/myblog/docs/coding/design-pattern/memento-pattern-basics"},"next":{"title":"\u539f\u578b\u6a21\u5f0f Prototype Pattern","permalink":"/myblog/docs/coding/design-pattern/prototype-pattern-basics"}}');var r=t(74848),a=t(28453);const c={},o="\u89c2\u5bdf\u8005\u6a21\u5f0f Observer Pattern",l={},i=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2},{value:"\u7f51\u9875\u4e8b\u4ef6\u7ed1\u5b9a",id:"\u7f51\u9875\u4e8b\u4ef6\u7ed1\u5b9a",level:3},{value:"jQuery callbacks",id:"jquery-callbacks",level:3},{value:"nodejs \u81ea\u5b9a\u4e49\u4e8b\u4ef6",id:"nodejs-\u81ea\u5b9a\u4e49\u4e8b\u4ef6",level:3},{value:"nodejs \u5904\u7406 http \u8bf7\u6c42\uff0c\u591a\u8fdb\u7a0b\u901a\u8baf",id:"nodejs-\u5904\u7406-http-\u8bf7\u6c42\u591a\u8fdb\u7a0b\u901a\u8baf",level:3},{value:"Vue React \u7ec4\u4ef6\u751f\u547d\u5468\u671f\u89e6\u53d1",id:"vue-react-\u7ec4\u4ef6\u751f\u547d\u5468\u671f\u89e6\u53d1",level:3},{value:"Vue watch",id:"vue-watch",level:3},{value:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",id:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u89c2\u5bdf\u8005\u6a21\u5f0f-observer-pattern",children:"\u89c2\u5bdf\u8005\u6a21\u5f0f Observer Pattern"})}),"\n",(0,r.jsx)(n.h2,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u53d1\u5e03 & \u8ba2\u9605"}),"\n",(0,r.jsx)(n.li,{children:"\u4e00\u5bf9\u591a"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,r.jsx)(n.p,{children:"\u7c7b\u56fe\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:"classDiagram\nObserver--\x3eSubject\nclass Observer {\n  + name: String\n  + subject: subject\n  +update() void\n}\nclass Subject {\n  - observers: Array\n  - state: init\n  +getState() init\n  +setState(state) void\n  +subscribe(observer) void\n  +unsubScribe(observer) void\n  +notifyAllObservers() void\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"class Subject {\n  constructor() {\n    this.state = 0\n    this.observers = []\n  }\n\n  getState() {\n    return this.state\n  }\n\n  setState(state) {\n    this.state = state\n    this.notifyAllObservers()\n  }\n\n  notifyAllObservers() {\n    this.observers.forEach(observer => {\n      observer.update()\n    })\n  }\n\n  subscribe(observer) {\n    this.observers.push(observer)\n  }\n\n  unsubScribe(observer) {\n    this.observers = this.observers.filter(o => o !== observer)\n  }\n}\n\nclass Observer {\n  constructor(name, subject) {\n    this.name = name\n    this.subject = subject\n    this.subject.subscribe(this)\n  }\n\n  update() {\n    console.log(`${this.name} update, state: ${this.subject.getState()}`)\n  }\n}\n\nlet s = new Subject()\nlet o = new Observer('olu', s)\ns.setState(1)\ns.unsubScribe(o)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n",(0,r.jsx)(n.h3,{id:"\u7f51\u9875\u4e8b\u4ef6\u7ed1\u5b9a",children:"\u7f51\u9875\u4e8b\u4ef6\u7ed1\u5b9a"}),"\n",(0,r.jsx)(n.p,{children:"\u4e8b\u4ef6\u76d1\u542c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"<button type=\"button\" id=\"btn\">olu cool</button>\n\n<script>\n  const btn = document.getElementById('btn');\n  btn.addEventListener('click', () => {\n    console.log(1)\n  })\n  btn.addEventListener('click', () => {\n    console.log(2)\n  })\n  btn.addEventListener('click', () => {\n    console.log(3)\n  })\n<\/script>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"jquery-callbacks",children:"jQuery callbacks"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const callbacks = $.Callbacks()\ncallbacks.add(info => {\n  console.log(1, info)\n})\ncallbacks.add(info => {\n  console.log(2, info)\n})\ncallbacks.add(info => {\n  console.log(3, info)\n})\ncallbacks.fire('olu')\n// 1 olu\n// 2 olu\n// 3 olu\n"})}),"\n",(0,r.jsx)(n.h3,{id:"nodejs-\u81ea\u5b9a\u4e49\u4e8b\u4ef6",children:"nodejs \u81ea\u5b9a\u4e49\u4e8b\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const EventEmitter = require('events').EventEmitter\n\nconst emitter1 = new EventEmitter()\n\nemitter1.on('some', () => {\n  console.log(1)\n})\n\nemitter2.on('some', () => {\n  console.log(2)\n})\n\nemitter1.emit('some')\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const EventEmitter = require('events').EventEmitter\n\nclass Dog extends EventEmitter {\n  constructor(name) {\n    super()\n    this.name = name\n  }\n}\n\nconst corgi = new Dog('Tango')\ncorgi.on('call', () => {\n  console.log(corgi.name, 'coming~')\n})\nsetInterval(() => {\n  corgi.emit('call')\n}, 500)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const fs = require('fs')\nconst readStream = fs.createReadStream('./data.txt')\n\nlet length = 0\nreadStream.on('data', chunk => {\n  length += chunk.toString().length\n})\nreadStream.on('end', () => {\n  console.log(length)\n})\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const readline = require('readline')\nconst fs = require('fs')\n\nconst rl = readline.createInterface({\n  input: fs.createReadStream('./data.txt')\n})\n\nlet lineNum = 0\nrl.on('line', line => {\n  lineNum += 1\n})\nrl.on('close', () => {\n  console.log(lineNum)\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"nodejs-\u5904\u7406-http-\u8bf7\u6c42\u591a\u8fdb\u7a0b\u901a\u8baf",children:"nodejs \u5904\u7406 http \u8bf7\u6c42\uff0c\u591a\u8fdb\u7a0b\u901a\u8baf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"function serverCallback(req, res) {\n  // \u83b7\u53d6\u8bf7\u6c42\n  const method = req.method.toLowerCase()\n  if (method === 'get') {\n    // ...\n  }\n  if (method === 'post') {\n    // \u63a5\u53d7\u8bf7\u6c42\u5185\u5bb9\n    let data = ''\n    req.on('data', chunk => {\n      data += chunk.toString()\n    })\n    req.on('end', () => {\n      // \u63a5\u6536\u5b8c\u6bd5\uff0c\u8f93\u51fa\u5185\u5bb9\n      res.writeHead(200, {'Content-type': 'application/json'})\n      res.write(data)\n      res.end()\n    })\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"vue-react-\u7ec4\u4ef6\u751f\u547d\u5468\u671f\u89e6\u53d1",children:"Vue React \u7ec4\u4ef6\u751f\u547d\u5468\u671f\u89e6\u53d1"}),"\n",(0,r.jsx)(n.h3,{id:"vue-watch",children:"Vue watch"}),"\n",(0,r.jsx)(n.h2,{id:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",children:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e3b\u9898\u548c\u89c2\u5bdf\u8005\u5206\u79bb\uff0c\u4e0d\u662f\u4e3b\u52a8\u89e6\u53d1\u800c\u662f\u88ab\u52a8\u76d1\u542c\uff0c\u4e24\u8005\u89e3\u8026"}),"\n",(0,r.jsx)(n.li,{children:"\u7b26\u5408\u5f00\u653e\u5c01\u95ed\u539f\u5219"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{376:function(v,_,e){"use strict";e.r(_);var t=e(10),o=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"浏览器的重排和重绘"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的重排和重绘"}},[v._v("#")]),v._v(" 浏览器的重排和重绘")]),v._v(" "),_("p",[v._v("浏览器渲染过程在解析 "),_("code",[v._v("HTML")]),v._v(" 后，会依次进入 "),_("code",[v._v("Layout")]),v._v(" 和 "),_("code",[v._v("Paint")]),v._v(" 阶段。"),_("strong",[v._v("样式或节点的更改，以及对布局信息的访问")]),v._v("，都有可能导致重排和重绘。\n重排和重绘的过程在主线程中进行，不合理的重排重绘会导致"),_("strong",[v._v("渲染卡顿，用户交互滞后")]),v._v("等性能问题")]),v._v(" "),_("h2",{attrs:{id:"什么是重排和重绘"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#什么是重排和重绘"}},[v._v("#")]),v._v(" 什么是重排和重绘")]),v._v(" "),_("h3",{attrs:{id:"基础概念"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#基础概念"}},[v._v("#")]),v._v(" 基础概念")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("Parse HTML")]),v._v("：相关引擎分别解析文档和样式表及脚本，生成 "),_("code",[v._v("DOM")]),v._v(" 和 "),_("code",[v._v("CSSOM")]),v._v("，最终合成 "),_("code",[v._v("Render 树")])]),v._v(" "),_("li",[_("code",[v._v("Layout")]),v._v("：浏览器通过 "),_("code",[v._v("Render 树")]),v._v("中的信息，以递归的形式计算出每个节点的尺寸大小和在页面中的具体位置")]),v._v(" "),_("li",[_("code",[v._v("Paint")]),v._v("：浏览器将 "),_("code",[v._v("Render 树")]),v._v("中的节点转换成在屏幕上绘制实际像素的指令，此过程发生在多个图层上")]),v._v(" "),_("li",[_("code",[v._v("Composite")]),v._v("：浏览器将所有层按照一定顺序合并为一个图层并绘制在屏幕上")])]),v._v(" "),_("p",[_("code",[v._v("DOM")]),v._v(" 或 "),_("code",[v._v("CSSOM")]),v._v(" 被修改，会导致浏览器重复执行上述步骤。重排和重绘，本质上是触发 "),_("code",[v._v("Layout")]),v._v(" 和 "),_("code",[v._v("Paint")]),v._v(" 的过程，并且"),_("strong",[v._v("重排必定导致重绘")])]),v._v(" "),_("h3",{attrs:{id:"引起重排-重绘的常见操作"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#引起重排-重绘的常见操作"}},[v._v("#")]),v._v(" 引起重排/重绘的常见操作")]),v._v(" "),_("ul",[_("li",[v._v("外观有变化时，会导致重绘，比如修改 "),_("code",[v._v("color")]),v._v(" "),_("code",[v._v("opacity")]),v._v(" 等样式属性")]),v._v(" "),_("li",[v._v("布局结构或者节点内容变化时，会导致重排，比如修改 "),_("code",[v._v("height")]),v._v(" "),_("code",[v._v("float")]),v._v(" "),_("code",[v._v("position")]),v._v(" 等样式属性\n"),_("ul",[_("li",[v._v("盒子尺寸和类型")]),v._v(" "),_("li",[v._v("定位方案（正常流、浮动和绝对定位）")]),v._v(" "),_("li",[v._v("文档树中元素之间的关系")]),v._v(" "),_("li",[v._v("外部信息（如视口大小）")])])]),v._v(" "),_("li",[v._v("获取布局信息时，会导致重排，比如使用 "),_("code",[v._v("offsetTop")]),v._v(" "),_("code",[v._v("getComputedStyle")])])]),v._v(" "),_("h2",{attrs:{id:"如何减少重排重绘"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#如何减少重排重绘"}},[v._v("#")]),v._v(" 如何减少重排重绘")]),v._v(" "),_("ul",[_("li",[v._v("对 "),_("code",[v._v("DOM")]),v._v(" 进行批量写入和读取（通过 "),_("code",[v._v("虚拟DOM")]),v._v(" 或者 "),_("code",[v._v("DocumentFragment")]),v._v(" 实现）")]),v._v(" "),_("li",[v._v("避免对样式进行频繁操作，了解常用样式属性触发 Layout/Paint/Composite 的机制，合理使用样式")]),v._v(" "),_("li",[v._v("合理利用特殊样式属性（如 "),_("code",[v._v("transform: translateZ(0)")]),v._v(" 或者 "),_("code",[v._v("will-change")]),v._v("）, 将渲染层提升为合成层，开启 "),_("code",[v._v("GPU 加速")]),v._v("，提高页面性能")]),v._v(" "),_("li",[v._v("使用变量对布局信息（如 "),_("code",[v._v("clientTop")]),v._v("进行缓存，避免频繁读取布局信息触发重排和重绘）")]),v._v(" "),_("li",[v._v("借助 "),_("code",[v._v("DevTools Performance")]),v._v(" 面板查看重排重绘任务占用主线程的情况和调用代码")])])])}),[],!1,null,null,null);_.default=o.exports}}]);
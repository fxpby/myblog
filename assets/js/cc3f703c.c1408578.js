"use strict";(self.webpackChunkmy_website_2=self.webpackChunkmy_website_2||[]).push([[6017],{28453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>o});var s=r(96540);const i={},t=s.createContext(i);function l(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),s.createElement(t.Provider,{value:e},n.children)}},57990:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"coding/browser/browser-router","title":"\u524d\u7aef\u8def\u7531","description":"1. \u8def\u7531\u662f\u4ec0\u4e48","source":"@site/docs/coding/browser/browser-router.md","sourceDirName":"coding/browser","slug":"/coding/browser/browser-router","permalink":"/myblog/docs/coding/browser/browser-router","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/coding/browser/browser-router.md","tags":[{"inline":true,"label":"\u8def\u7531","permalink":"/myblog/docs/tags/\u8def\u7531"},{"inline":true,"label":"Hash \u8def\u7531","permalink":"/myblog/docs/tags/hash-\u8def\u7531"},{"inline":true,"label":"History \u8def\u7531","permalink":"/myblog/docs/tags/history-\u8def\u7531"}],"version":"current","frontMatter":{"id":"browser-router","title":"\u524d\u7aef\u8def\u7531","tags":["\u8def\u7531","Hash \u8def\u7531","History \u8def\u7531"]},"sidebar":"tutorialSidebar","previous":{"title":"\u6d4f\u89c8\u5668\u4e8b\u4ef6\u5faa\u73af","permalink":"/myblog/docs/coding/browser/browser-event-loop"},"next":{"title":"\u6d4f\u89c8\u5668\u5b58\u50a8\u578b\u7f13\u5b58\u65b9\u6848","permalink":"/myblog/docs/coding/browser/browser-storage-caching-scheme"}}');var i=r(74848),t=r(28453);const l={id:"browser-router",title:"\u524d\u7aef\u8def\u7531",tags:["\u8def\u7531","Hash \u8def\u7531","History \u8def\u7531"]},o=void 0,a={},h=[{value:"1. \u8def\u7531\u662f\u4ec0\u4e48",id:"1-\u8def\u7531\u662f\u4ec0\u4e48",level:2},{value:"2. Hash \u8def\u7531",id:"2-hash-\u8def\u7531",level:2},{value:"2.1 \u5b9e\u73b0\u539f\u7406",id:"21-\u5b9e\u73b0\u539f\u7406",level:3},{value:"2.2 \u4f18\u70b9",id:"22-\u4f18\u70b9",level:3},{value:"2.3 \u7f3a\u70b9",id:"23-\u7f3a\u70b9",level:3},{value:"3. History \u8def\u7531",id:"3-history-\u8def\u7531",level:2},{value:"3.1 \u5b9e\u73b0\u539f\u7406",id:"31-\u5b9e\u73b0\u539f\u7406",level:3},{value:"3.2 \u4f18\u70b9",id:"32-\u4f18\u70b9",level:3},{value:"3.3 \u7f3a\u70b9",id:"33-\u7f3a\u70b9",level:3},{value:"4. \u524d\u7aef\u8def\u7531\u7684\u4f18\u7f3a\u70b9",id:"4-\u524d\u7aef\u8def\u7531\u7684\u4f18\u7f3a\u70b9",level:2},{value:"4.1 \u4f18\u70b9",id:"41-\u4f18\u70b9",level:3},{value:"4.2 \u7f3a\u70b9",id:"42-\u7f3a\u70b9",level:3}];function c(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"1-\u8def\u7531\u662f\u4ec0\u4e48",children:"1. \u8def\u7531\u662f\u4ec0\u4e48"}),"\n",(0,i.jsx)(e.p,{children:"URL \u5230\u5bf9\u5e94\u5904\u7406\u7a0b\u5e8f\u7684\u6620\u5c04"}),"\n",(0,i.jsxs)(e.p,{children:["web \u8def\u7531\u53ef\u4ee5\u7531",(0,i.jsx)(e.strong,{children:"\u670d\u52a1\u7aef"}),"\u6216",(0,i.jsx)(e.strong,{children:"\u524d\u7aef"}),"\u5b9e\u73b0\uff0c\u6839\u636e\u5b9e\u73b0\u65b9\u5f0f\u5206\u4e3a",(0,i.jsx)(e.strong,{children:"Hash \u8def\u7531"})," \u548c ",(0,i.jsx)(e.strong,{children:"History \u8def\u7531"})]}),"\n",(0,i.jsx)(e.p,{children:"\u524d\u7aef\u8def\u7531 \u76f8\u5bf9\u4e8e \u670d\u52a1\u7aef\u8def\u7531\uff0c\u53ef\u4ee5\u5728\u9875\u9762\u65e0\u5237\u65b0\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u9875\u9762\u5207\u6362\uff0c\u6545\u4ea7\u751f\u4e86\u65e0\u5237\u65b0\u7684\u5355\u9875\u5e94\u7528\u5f00\u53d1\u6a21\u5f0f SPA"}),"\n",(0,i.jsx)(e.h2,{id:"2-hash-\u8def\u7531",children:"2. Hash \u8def\u7531"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 URI \u7684\u7ec4\u6210\u4e2d\uff0c fragment \u662f Hash \u8def\u7531\u6240\u8bfb\u53d6\u7684\u5185\u5bb9"}),"\n",(0,i.jsx)(e.p,{children:"fragment \u672c\u8d28\u662f\u7528\u6765\u6807\u8bc6\u6b21\u7ea7\u8d44\u6e90\uff0c\u5177\u6709\u4ee5\u4e0b\u7279\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539 fragment \u5185\u5bb9\u4e0d\u4f1a\u89e6\u53d1\u7f51\u9875\u91cd\u8f7d"}),"\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539 fragment \u5185\u5bb9\u4f1a\u6539\u53d8\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55"}),"\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539 fragment \u5185\u5bb9\u4f1a\u89e6\u53d1\u6d4f\u89c8\u5668 onhashchange \u4e8b\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"21-\u5b9e\u73b0\u539f\u7406",children:"2.1 \u5b9e\u73b0\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u76d1\u542c hashchange \u4e8b\u4ef6\u76d1\u542c\u9875\u9762 hash \u53d8\u5316\uff0c\u89e3\u6790 hash \u503c\u6765\u5207\u6362\u9875\u9762"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:'/**\r\n * \u89e3\u6790 hash\r\n */\r\nconst parseHash = hash => {\r\n  // \u53bb\u9664 # \u53f7\r\n  hash = hash.replace(/^#/, "")\r\n\r\n  const parsed = hash.split("?")\r\n\r\n  // \u8fd4\u56de hash path \u548c query\r\n  return {\r\n    pathname: parsed[0],\r\n    search: parsed[1]\r\n  }\r\n}\r\n\r\nconst onHashChange = () => {\r\n  const {pathname, search} = parseHash(location.hash)\r\n\r\n  // \u5207\u6362\u9875\u9762\u5185\u5bb9\r\n  switch(pathname) {\r\n    case "/home":\r\n      document.body.innerHTML = `olu cool`\r\n      return\r\n    default:\r\n      return\r\n  }\r\n}\r\n\r\nwindow.addEventListener("hashchange", onHashChange)\n'})}),"\n",(0,i.jsx)(e.h3,{id:"22-\u4f18\u70b9",children:"2.2 \u4f18\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u517c\u5bb9\u6027\u597d"}),"\n",(0,i.jsx)(e.li,{children:"\u65e0\u9700\u670d\u52a1\u7aef\u914d\u7f6e"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"23-\u7f3a\u70b9",children:"2.3 \u7f3a\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7aef\u65e0\u6cd5\u83b7\u53d6 hash \u90e8\u5206\u5185\u5bb9"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u80fd\u4f1a\u548c\u951a\u70b9\u529f\u80fd\u51b2\u7a81"}),"\n",(0,i.jsx)(e.li,{children:"SEO \u4e0d\u53cb\u597d"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"3-history-\u8def\u7531",children:"3. History \u8def\u7531"}),"\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u6d4f\u89c8\u5668\u539f\u751f\u63d0\u4f9b\u7684\u64cd\u4f5c History \u7684\u80fd\u529b\u5b9e\u73b0\u8def\u7531\u529f\u80fd"}),"\n",(0,i.jsx)(e.h3,{id:"31-\u5b9e\u73b0\u539f\u7406",children:"3.1 \u5b9e\u73b0\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u4f9d\u8d56 History API \u4e2d\u7684 pushState \u65b9\u6cd5 \u548c replaceState \u65b9\u6cd5 \u4ee5\u53ca popstate \u4e8b\u4ef6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"history.pushState\uff1a\u5c06\u7ed9\u5b9a\u7684 Data \u6dfb\u52a0\u5230\u5f53\u524d\u6807\u7b7e\u9875\u7684\u5386\u53f2\u8bb0\u5f55\u6808\u4e2d"}),"\n",(0,i.jsx)(e.li,{children:"history.replaceState\uff1a\u5c06\u7ed9\u5b9a\u7684 Data \u66f4\u65b0\u5230\u5386\u53f2\u8bb0\u5f55\u6808\u4e2d\u6700\u65b0\u7684\u4e00\u6761\u8bb0\u5f55\u4e2d"}),"\n",(0,i.jsx)(e.li,{children:"popstate: \u76d1\u542c\u5386\u53f2\u8bb0\u5f55\u7684\u53d8\u5316"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const onHistoryChange = () => {\r\n  const {pathname, search} = location\r\n\r\n  // \u6839\u636e\u4e0d\u540c\u9875\u9762\u6267\u884c\u4e0d\u540c\u5185\u5bb9\r\n  switch (pathname) {\r\n    case '/home':\r\n      document.body.innerHTML = `olu cool, ${search.replace(/^\\?/, \"\")}`\r\n      return\r\n    default:\r\n      document.body.innerHTML = 'olu cute'\r\n      return\r\n  }\r\n}\r\n\r\n// \u9875\u9762\u8df3\u8f6c\r\nconst pushState = (target) => {\r\n  history.pushState(null, '', target)\r\n  onHistoryChange()\r\n}\r\n\r\n// xx \u79d2\u540e\u8def\u7531\u8df3\u8f6c\r\nsetTimeout(() => {\r\n  pushState(\"/home?name=oluCool\")\r\n}, 2000)\r\n\r\nsetTimeout(() => {\r\n  history.back()\r\n}, 6000)\r\n\r\nwindow.addEventListener(\"popstate\", onHistoryChange)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"32-\u4f18\u70b9",children:"3.2 \u4f18\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7aef\u53ef\u4ee5\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u94fe\u63a5\u548c\u53c2\u6570"}),"\n",(0,i.jsx)(e.li,{children:"\u524d\u7aef\u76d1\u63a7\u53cb\u597d"}),"\n",(0,i.jsx)(e.li,{children:"SEO \u76f8\u5bf9 Hash \u53cb\u597d"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"33-\u7f3a\u70b9",children:"3.3 \u7f3a\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u517c\u5bb9\u6027\u7a0d\u5f31"}),"\n",(0,i.jsx)(e.li,{children:"\u9700\u8981\u670d\u52a1\u7aef\u989d\u5916\u914d\u7f6e\uff08\u5404 path \u5747\u6307\u5411\u540c\u4e00\u4e2a HTML\uff09"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"4-\u524d\u7aef\u8def\u7531\u7684\u4f18\u7f3a\u70b9",children:"4. \u524d\u7aef\u8def\u7531\u7684\u4f18\u7f3a\u70b9"}),"\n",(0,i.jsx)(e.h3,{id:"41-\u4f18\u70b9",children:"4.1 \u4f18\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u65e0\u5237\u65b0\u5207\u6362\u5185\u5bb9\uff0c\u4f53\u9a8c\u66f4\u597d"}),"\n",(0,i.jsx)(e.li,{children:"\u51cf\u8f7b\u670d\u52a1\u7aef\u538b\u529b"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"42-\u7f3a\u70b9",children:"4.2 \u7f3a\u70b9"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u521d\u6b21\u52a0\u8f7d\u8017\u65f6\u957f"}),"\n",(0,i.jsx)(e.li,{children:"SEO \u6548\u679c\u8f83\u5dee"}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}}}]);
"use strict";(self.webpackChunkmy_website_2=self.webpackChunkmy_website_2||[]).push([[262],{28453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>o});var t=r(96540);const a={},s=t.createContext(a);function i(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),t.createElement(s.Provider,{value:e},n.children)}},95300:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"coding/design-pattern/proxy-pattern-basics","title":"\u4ee3\u7406\u6a21\u5f0f Proxy Pattern","description":"\u4ecb\u7ecd","source":"@site/docs/coding/design-pattern/proxy-pattern-basics.md","sourceDirName":"coding/design-pattern","slug":"/coding/design-pattern/proxy-pattern-basics","permalink":"/docs/coding/design-pattern/proxy-pattern-basics","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/coding/design-pattern/proxy-pattern-basics.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u539f\u578b\u6a21\u5f0f Prototype Pattern","permalink":"/docs/coding/design-pattern/prototype-pattern-basics"},"next":{"title":"\u5355\u4f8b\u6a21\u5f0f Singleton Pattern","permalink":"/docs/coding/design-pattern/singleton-pattern-basics"}}');var a=r(74848),s=r(28453);const i={},o="\u4ee3\u7406\u6a21\u5f0f Proxy Pattern",l={},c=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2},{value:"\u56fe\u7247\u61d2\u52a0\u8f7d",id:"\u56fe\u7247\u61d2\u52a0\u8f7d",level:3},{value:"\u7f51\u9875\u4e8b\u4ef6\u4ee3\u7406",id:"\u7f51\u9875\u4e8b\u4ef6\u4ee3\u7406",level:3},{value:"jQuery $.proxy",id:"jquery-proxy",level:3},{value:"ES6 Proxy",id:"es6-proxy",level:3},{value:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",id:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"\u4ee3\u7406\u6a21\u5f0f-proxy-pattern",children:"\u4ee3\u7406\u6a21\u5f0f Proxy Pattern"})}),"\n",(0,a.jsx)(e.h2,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528\u8005\u65e0\u6743\u8bbf\u95ee\u76ee\u6807\u5bf9\u8c61"}),"\n",(0,a.jsx)(e.li,{children:"\u4e2d\u95f4\u52a0\u4ee3\u7406\uff0c\u901a\u8fc7\u4ee3\u7406\u505a\u6388\u6743\u548c\u63a7\u5236"}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,a.jsx)(e.p,{children:"\u7c7b\u56fe\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-mermaid",children:"classDiagram\n\nClient --\x3e ProxyImg\nProxyImg --\x3e RealImg\n\nclass Client {\n  + proxyImg: ProxyImg\n  +main () void\n}\n\nclass ProxyImg {\n  + realImg: RealImg\n  +display() void\n}\n\nclass RealImg {\n  + fileName: String\n  +display() void\n  -loadFromDisk() void\n}\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:"class RealImg {\n  constructor(fileName) {\n    this.fileName = fileName\n    this.loadFromDisk()\n  }\n\n  loadFromDisk() {\n    console.log(`loading...${this.fileName}`)\n  }\n\n  display() {\n    console.log(`display...${this.fileName}`)\n  }\n}\n\nclass ProxyImg {\n  constructor(fileName) {\n    this.realImg = new RealImg(fileName)\n  }\n\n  display() {\n    this.realImg.display()\n  }\n}\n\nconst proxyImg = new ProxyImg('hello')\nproxyImg.display()\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n",(0,a.jsx)(e.h3,{id:"\u56fe\u7247\u61d2\u52a0\u8f7d",children:"\u56fe\u7247\u61d2\u52a0\u8f7d"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:"const loadingImgUrl = 'xxx'\nconst realImgUrl = 'xxx'\n\nconst myImage = (() => {\n  const imgNode = document.createElement('img')\n  document.append(imgNode)\n  return {\n    setSrc: (src) => {\n      imgNode.src = src\n    }\n  }\n})()\n\nconst proxyImage = (() => {\n  const img = new Image()\n  img.onload = () => {\n    myImage.setSrc(img.src)\n  }\n  return {\n    setSrc: (src) => {\n      myImage.setSrc(loadingImgUrl)\n      img.src = src\n    }\n  }\n})()\n\nproxyImage.setSrc(realImgUrl)\n"})}),"\n",(0,a.jsx)(e.h3,{id:"\u7f51\u9875\u4e8b\u4ef6\u4ee3\u7406",children:"\u7f51\u9875\u4e8b\u4ef6\u4ee3\u7406"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-html",children:'<div id="wrapper">\n  <a href="#">a1</a>\n  <a href="#">a2</a>\n  <a href="#">a3</a>\n  <a href="#">a4</a>\n  <a href="#">a5</a>\n  <a href="#">a6</a>\n</div>\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:"const wrapper = document.getElementById('wrapper')\n// \u76d1\u542c\u6240\u6709 a \u6807\u7b7e\u7684\u70b9\u51fb\u4e8b\u4ef6\nwrapper.addEventListener('click', e => {\n  const target = e.target\n  if (target.nodeName === 'A') {\n    console.log(target.innerHTML)\n  }\n})\n"})}),"\n",(0,a.jsx)(e.h3,{id:"jquery-proxy",children:"jQuery $.proxy"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:"$('#wrapper').click(function () {\n  setTimeout($.proxy(function() {\n    $(this).addClass('hello')\n  }, this), 500)\n})\n"})}),"\n",(0,a.jsx)(e.h3,{id:"es6-proxy",children:"ES6 Proxy"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:"// \u660e\u661f\nconst star = {\n  name: 'olu', \n  age: 18,\n  phone: 120110109,\n}\n\n// \u7ecf\u7eaa\u4eba\nconst agent = new Proxy(star, {\n  get: function(target, key) {\n    if (key === 'phone') {\n      // \u8fd4\u56de\u7ecf\u7eaa\u4eba\u7684\u624b\u673a\u53f7\n      return 12315\n    }\n    if (key === 'price') {\n      // \u7ecf\u7eaa\u4eba\u4ee3\u66ff\u660e\u661f\u62a5\u4ef7\n      return 521\n    }\n    return target[key]\n  }, \n  set: function(target, key, val) {\n    if (key === 'customPrice') {\n      if (val < 520) {\n        // \u62a5\u4ef7\u6700\u4f4e 520\n        throw new Error('olu \u6ca1\u6709\u8fd9\u4e48\u4fbf\u5b9c\uff01')\n      } else {\n        target[key] = val\n        return true\n      }\n    }\n  }\n})\n\nconsole.log(agent.name) // \u660e\u661f\u7684\nconsole.log(agent.age) // \u660e\u661f\u7684\nconsole.log(agent.phone) // \u7ecf\u7eaa\u4eba\u7684\nconsole.log(agent.price) // \u7ecf\u7eaa\u4eba\u63d0\u4f9b\nagent.customPrice = 11 // error\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",children:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u4ee3\u7406\u7c7b\u548c\u76ee\u6807\u7c7b\u5206\u79bb\uff0c\u9694\u79bb\u5f00\u76ee\u6807\u7c7b\u548c\u4f7f\u7528\u8005"}),"\n",(0,a.jsx)(e.li,{children:"\u7b26\u5408\u5f00\u653e\u5c01\u95ed\u539f\u5219"}),"\n"]})]})}function g(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}}}]);
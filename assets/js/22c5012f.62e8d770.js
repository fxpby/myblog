"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2036],{3905:(t,n,e)=>{e.d(n,{Zo:()=>h,kt:()=>p});var a=e(7294);function s(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,a)}return e}function r(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(Object(e),!0).forEach((function(n){s(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function o(t,n){if(null==t)return{};var e,a,s=function(t,n){if(null==t)return{};var e,a,s={},i=Object.keys(t);for(a=0;a<i.length;a++)e=i[a],n.indexOf(e)>=0||(s[e]=t[e]);return s}(t,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)e=i[a],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(s[e]=t[e])}return s}var l=a.createContext({}),c=function(t){var n=a.useContext(l),e=n;return t&&(e="function"==typeof t?t(n):r(r({},n),t)),e},h=function(t){var n=c(t.components);return a.createElement(l.Provider,{value:n},t.children)},g={inlineCode:"code",wrapper:function(t){var n=t.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(t,n){var e=t.components,s=t.mdxType,i=t.originalType,l=t.parentName,h=o(t,["components","mdxType","originalType","parentName"]),u=c(e),p=s,d=u["".concat(l,".").concat(p)]||u[p]||g[p]||i;return e?a.createElement(d,r(r({ref:n},h),{},{components:e})):a.createElement(d,r({ref:n},h))}));function p(t,n){var e=arguments,s=n&&n.mdxType;if("string"==typeof t||s){var i=e.length,r=new Array(i);r[0]=u;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=t,o.mdxType="string"==typeof t?t:s,r[1]=o;for(var c=2;c<i;c++)r[c]=e[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,e)}u.displayName="MDXCreateElement"},7777:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>g,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var a=e(7462),s=(e(7294),e(3905));const i={},r="\u72b6\u6001\u6a21\u5f0f State Pattern",o={unversionedId:"design-pattern/state-pattern/state-pattern-basics",id:"design-pattern/state-pattern/state-pattern-basics",title:"\u72b6\u6001\u6a21\u5f0f State Pattern",description:"\u4ecb\u7ecd",source:"@site/docs/design-pattern/state-pattern/state-pattern-basics.md",sourceDirName:"design-pattern/state-pattern",slug:"/design-pattern/state-pattern/state-pattern-basics",permalink:"/myblog/docs/design-pattern/state-pattern/state-pattern-basics",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/design-pattern/state-pattern/state-pattern-basics.md",tags:[],version:"current",frontMatter:{},sidebar:"design-pattern",previous:{title:"\u8fed\u4ee3\u5668\u6a21\u5f0f Iterator Pattern",permalink:"/myblog/docs/design-pattern/iterator-pattern/iterator-pattern-basics"},next:{title:"\u539f\u578b\u6a21\u5f0f Prototype Pattern",permalink:"/myblog/docs/design-pattern/prototype-pattern/prototype-pattern-basics"}},l={},c=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u7535\u706f\u7a0b\u5e8f",id:"\u7535\u706f\u7a0b\u5e8f",level:3},{value:"\u4ea4\u901a\u4fe1\u53f7\u706f\u4e0d\u540c\u989c\u8272\u7684\u53d8\u5316",id:"\u4ea4\u901a\u4fe1\u53f7\u706f\u4e0d\u540c\u989c\u8272\u7684\u53d8\u5316",level:3},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2},{value:"\u6709\u9650\u72b6\u6001\u673a",id:"\u6709\u9650\u72b6\u6001\u673a",level:3},{value:"javascript-state-machine",id:"javascript-state-machine",level:3},{value:"\u624b\u5199\u7b80\u964b Promise",id:"\u624b\u5199\u7b80\u964b-promise",level:3},{value:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",id:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1",level:2}],h={toc:c};function g(t){let{components:n,...e}=t;return(0,s.kt)("wrapper",(0,a.Z)({},h,e,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"\u72b6\u6001\u6a21\u5f0f-state-pattern"},"\u72b6\u6001\u6a21\u5f0f State Pattern"),(0,s.kt)("h2",{id:"\u4ecb\u7ecd"},"\u4ecb\u7ecd"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u5bf9\u8c61\u6709\u72b6\u6001\u53d8\u5316"),(0,s.kt)("li",{parentName:"ul"},"\u6bcf\u6b21\u72b6\u6001\u53d8\u5316\u90fd\u4f1a\u89e6\u53d1\u4e00\u4e2a\u903b\u8f91"),(0,s.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u603b\u662f\u7528 if...else \u6765\u63a7\u5236")),(0,s.kt)("h2",{id:"\u793a\u4f8b"},"\u793a\u4f8b"),(0,s.kt)("h3",{id:"\u7535\u706f\u7a0b\u5e8f"},"\u7535\u706f\u7a0b\u5e8f"),(0,s.kt)("p",null,"\u6709\u4e00\u4e2a\u7535\u706f\uff0c\u7535\u706f\u4e0a\u9762\u53ea\u6709\u4e00\u4e2a\u5f00\u5173\u3002\u7535\u706f\u5f00\u7740\u7684\u65f6\u5019\uff0c\u6309\u4e0b\u5f00\u5173\uff0c\u7535\u706f\u4f1a\u5207\u6362\u5230\u5173\u95ed\u72b6\u6001\uff1b\u518d\u6309\u4e00\u6b21\u5f00\u5173\uff0c\u7535\u706f\u53c8\u88ab\u6253\u5f00\u3002\u540c\u4e00\u4e2a\u5f00\u5173\u6309\u94ae\uff0c\u5728\u4e0d\u540c\u7684\u72b6\u6001\u4e0b\uff0c\u8868\u73b0\u51fa\u6765\u7684\u884c\u4e3a\u662f\u4e0d\u4e00\u6837\u7684\u3002"),(0,s.kt)("p",null,"\u5148\u5b9a\u4e49\u4e00\u4e2a ",(0,s.kt)("inlineCode",{parentName:"p"},"Light")," \u7c7b\uff0c\u7535\u706f\u5bf9\u8c61 ",(0,s.kt)("inlineCode",{parentName:"p"},"light")," \u5c06\u4ece ",(0,s.kt)("inlineCode",{parentName:"p"},"Light"),"\u7c7b\u4e2d\u521b\u5efa\u3002",(0,s.kt)("inlineCode",{parentName:"p"},"light"),"\u5bf9\u8c61\u6709\u4e24\u4e2a\u5c5e\u6027\uff0c\u7528",(0,s.kt)("inlineCode",{parentName:"p"},"state"),"\u6765\u8bb0\u5f55\u7535\u706f\u5f53\u524d\u7684\u72b6\u6001\uff0c",(0,s.kt)("inlineCode",{parentName:"p"},"button"),"\u8868\u793a\u5177\u4f53\u7684\u5f00\u5173\u6309\u94ae\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class Light {\n  constructor() {\n    this.state = 'off'\n    this.button = null\n  }\n\n  init() {\n    const btnDom = document.createElement('button')\n    btnDom.innerHTML = '\u5f00\u5173'\n    this.button = document.body.appendChild(btnDom)\n    this.button.onclick = () => {\n      this.buttonPressHandler()\n    }\n  }\n\n  buttonPressHandler() {\n    if (this.state === 'off') {\n      console.log('\u5f00\u706f')\n      this.state = 'on'\n    } else if (this.state === 'on') {\n      console.log('\u5173\u706f')\n      this.state = 'off'\n    }\n  }\n}\n\nconst light = new Light()\nlight.init()\n")),(0,s.kt)("p",null,"\u6211\u4eec\u77e5\u9053\u7535\u706f\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u5982\u62a4\u773c\u706f\u53ef\u4ee5\u5207\u5f31\u5149\u706f\u548c\u5f3a\u5149\u706f\uff0c\u5f00\u5173\u6309\u4e00\u4e0b\u662f\u5f31\u5149\uff0c\u6309\u4e24\u4e0b\u662f\u5f3a\u5149\uff0c\u7b2c\u4e09\u4e0b\u624d\u662f\u5173\u706f"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"buttonPressHandler() {\n  if (this.state === 'off') {\n    console.log('\u5f00\u5f31\u5149')\n    this.state = 'weakLight'\n  } else if (this.state === 'weakLight') {\n    console.log('\u5f00\u5f3a\u5149')\n    this.state = 'strongLight'\n  } else if (this.state === 'strongLight') {\n    console.log('\u5173\u706f')\n    this.state = 'off'\n  }\n}\n")),(0,s.kt)("p",null,"\u5982\u679c\u50cf\u4e0a\u9762\u8fd9\u6837\u641e\uff0c\u6bcf\u6b21\u65b0\u589e\u6216\u8005\u4fee\u6539 ",(0,s.kt)("inlineCode",{parentName:"p"},"light")," \u7684\u72b6\u6001\u90fd\u9700\u8981\u6539\u52a8 ",(0,s.kt)("inlineCode",{parentName:"p"},"buttonPressHandler")," \u91cc\u9762\u7684\u5185\u5bb9\uff0c\u8fd9\u662f\u8fdd\u53cd\u5f00\u653e\u5c01\u95ed\u539f\u5219\u7684\u3002"),(0,s.kt)("p",null,"\u901a\u5e38\u60c5\u51b5\u6211\u4eec\u8bf4\u5c01\u88c5\uff0c\u4e00\u822c\u90fd\u4f1a\u4f18\u5148\u5c01\u88c5\u5bf9\u8c61\u7684\u884c\u4e3a\u800c\u4e0d\u662f\u5bf9\u8c61\u7684\u72b6\u6001\u3002\u72b6\u6001\u6a21\u5f0f\u5374\u4e0d\u662f\u5982\u6b64\uff0c\u72b6\u6001\u6a21\u5f0f\u7684\u5173\u952e\u70b9\u662f",(0,s.kt)("strong",{parentName:"p"},"\u628a\u4e8b\u7269\u7684\u6bcf\u79cd\u72b6\u6001\u90fd\u5c01\u88c5\u6210\u5355\u72ec\u7684\u7c7b"),"\uff0c\u8ddf\u72b6\u6001\u6709\u5173\u7684\u884c\u4e3a\u90fd\u88ab\u5c01\u88c5\u5728\u8fd9\u4e2a\u7c7b\u7684\u5185\u90e8\u3002"),(0,s.kt)("p",null,"\u6539\u7528\u72b6\u6001\u6a21\u5f0f\u7684\u8bdd\uff0c\u9488\u5bf9\u4e0a\u9762\u7684\u4f8b\u5b50\u9700\u8981\u5b9a\u4e49 3 \u4e2a\u72b6\u6001\u7c7b\uff0c\u5206\u522b\u662f",(0,s.kt)("inlineCode",{parentName:"p"},"OffLightState"),"\u3001",(0,s.kt)("inlineCode",{parentName:"p"},"WeakLightState"),"\u548c",(0,s.kt)("inlineCode",{parentName:"p"},"StrongLightState"),", \u8fd9 3 \u4e2a\u7c7b\u90fd\u6709\u4e00\u4e2a\u539f\u578b\u65b9\u6cd5 ",(0,s.kt)("inlineCode",{parentName:"p"},"buttonPressHandler"),"\uff0c\u4ee3\u8868\u5728\u5404\u81ea\u72b6\u6001\u4e0b\uff0c\u6309\u94ae\u88ab\u6309\u4e0b\u65f6\u5c06\u53d1\u751f\u7684\u884c\u4e3a\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class OffLightState {\n  constructor(light) {\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5f31\u5149')\n    this.light.setState(this.light.weakLightState)\n  }\n}\n\nclass WeakLightState {\n  constructor(light) {\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5f3a\u5149')\n    this.light.setState(this.light.strongLightState)\n  }\n}\n\nclass OffLightState {\n  constructor(light) {\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5173\u706f')\n    this.light.setState(this.light.offLightState)\n  }\n}\n")),(0,s.kt)("p",null,"\u4e0b\u9762\u6539\u5199 ",(0,s.kt)("inlineCode",{parentName:"p"},"Light")," \u7c7b\uff0c\u5bf9\u6bcf\u4e00\u4e2a\u72b6\u6001\u7c7b\u90fd\u521b\u5efa\u4e00\u4e2a\u72b6\u6001\u5bf9\u8c61"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class Light {\n  constructor() {\n    this.offLightState = new OffLightState(this)\n    this.weakLightState = new WeakLightState(this)\n    this.strongLightState = new StrongLightState(this)\n    this.button = null\n  }\n}\n")),(0,s.kt)("p",null,"\u901a\u8fc7 ",(0,s.kt)("inlineCode",{parentName:"p"},"currentState.buttonPressHandler()"),"\u5c06\u8bf7\u6c42\u59d4\u6258\u7ed9\u5f53\u524d\u6301\u6709\u7684\u72b6\u6001\u5bf9\u8c61\u53bb\u6267\u884c"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class Light {\n  constructor() {\n    this.offLightState = new OffLightState(this)\n    this.weakLightState = new WeakLightState(this)\n    this.strongLightState = new StrongLightState(this)\n    this.button = null\n  }\n\n  setState(newState) {\n    this.currentState = newState\n  }\n\n  init() {\n    const btnDom = document.createElement(\"button\")\n    this.button = document.body.appendChild(btnDom)\n    this.botton.innerHTML = '\u5f00\u5173'\n    this.currentState = this.offLightState\n    this.button.onclick = () => {\n      this.currentState.buttonPressHandler()\n    }\n  }\n}\n")),(0,s.kt)("p",null,"\u6700\u7ec8\u4ee3\u7801\u5982\u4e0b\ud83d\udc47\ud83c\udffb"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class OffLightState {\n  constructor(light) {\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5f31\u5149')\n    this.light.setState(this.light.weakLightState)\n  }\n}\n\nclass WeakLightState {\n  constructor(light) {\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5f3a\u5149')\n    this.light.setState(this.light.strongLightState)\n  }\n}\n\nclass StrongLightState {\n  constructor(light) {\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5173\u706f')\n    this.light.setState(this.light.offLightState)\n  }\n} \n\nclass Light {\n  constructor() {\n    this.offLightState = new OffLightState(this)\n    this.weakLightState = new WeakLightState(this)\n    this.strongLightState = new StrongLightState(this)\n    this.button = null\n  }\n\n  setState(newState) {\n    this.currentState = newState\n  }\n\n  init() {\n    const btnDom = document.createElement(\"button\")\n    btnDom.innerHTML = '\u5f00\u5173'\n    this.button = document.body.appendChild(btnDom)\n    this.currentState = this.offLightState\n    this.button.onclick = () => {\n      this.currentState.buttonPressHandler()\n    }\n  }\n}\n\nconst light = new Light()\nlight.init()\n")),(0,s.kt)("p",null,"\u8fd9\u6837\u7684\u8bdd\uff0c\u5982\u679c\u54ea\u5929\u65b0\u589e\u52a0\u4e86\u4e00\u79cd\u65b0\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u8d85\u5f3a\u5149\uff0c\u90a3\u4e48\u5c31\u53ea\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u72b6\u6001\u7c7b\uff0c\u518d\u5728 Light \u7c7b\u4e2d\u65b0\u589e\u4e00\u4e2a\u5bf9\u8c61\u3002\n\u89c2\u5bdf\u53d1\u73b0\u72b6\u6001\u7c7b\u4e2d\u6709\u4e00\u4e9b\u5171\u540c\u7684\u884c\u4e3a\u65b9\u6cd5\uff0cContext(\u53ca\u7c7b\u4e5f\u79f0\u4f5c\u4e0a\u4e0b\u6587) \u6700\u7ec8\u4f1a\u5c06\u8bf7\u6c42\u59d4\u6258\u7ed9\u72b6\u6001\u5bf9\u8c61\u7684\u8fd9\u4e9b\u65b9\u6cd5\u3002\u5373\u4e0a\u9762\u4f8b\u5b50\u4e2d\u7684 buttonPressHandler\u3002\n\u5982\u679c\u67d0\u6b21\u5fd8\u8bb0\u7ed9\u72b6\u6001\u5b50\u7c7b\u5b9e\u73b0 buttonPressHandler \u65b9\u6cd5\uff0c\u5c31\u5f88\u7cdf\u7cd5\u4e86\u3002\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u641e\u4e00\u4e2a\u62bd\u8c61\u7236\u7c7b\uff0c\u8ba9\u72b6\u6001\u5b50\u7c7b\u53bb\u7ee7\u627f\uff0c\u5e76\u5728\u62bd\u8c61\u7236\u7c7b\u4e2d\u7559\u4e0b\u629b\u5f02\u5e38\u7684\u884c\u4e3a\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class State {\n  buttonPressHandler() {\n    throw new Error(\"\u7236\u7c7b\u7684 buttonPressHandler \u65b9\u6cd5\u5fc5\u987b\u88ab\u91cd\u5199\")\n  }\n}\n\nclass OffLightState extends State {\n  constructor(light) {\n    super()\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5f31\u5149')\n    this.light.setState(this.light.weakLightState)\n  }\n}\n\n\nclass WeakLightState extends State {\n  constructor(light) {\n    super()\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5f3a\u5149')\n    this.light.setState(this.light.strongLightState)\n  }\n}\n\nclass StrongLightState extends State {\n  constructor(light) {\n    super()\n    this.light = light\n  }\n\n  buttonPressHandler() {\n    console.log('\u5173\u706f')\n    this.light.setState(this.light.offLightState)\n  }\n} \n\nclass Light {\n  constructor() {\n    this.offLightState = new OffLightState(this)\n    this.weakLightState = new WeakLightState(this)\n    this.strongLightState = new StrongLightState(this)\n    this.button = null\n  }\n\n  setState(newState) {\n    this.currentState = newState\n  }\n\n  init() {\n    const btnDom = document.createElement(\"button\")\n    btnDom.innerHTML = '\u5f00\u5173'\n    this.button = document.body.appendChild(btnDom)\n    this.currentState = this.offLightState\n    this.button.onclick = () => {\n      this.currentState.buttonPressHandler()\n    }\n  }\n}\n\nconst light = new Light()\nlight.init()\n")),(0,s.kt)("h3",{id:"\u4ea4\u901a\u4fe1\u53f7\u706f\u4e0d\u540c\u989c\u8272\u7684\u53d8\u5316"},"\u4ea4\u901a\u4fe1\u53f7\u706f\u4e0d\u540c\u989c\u8272\u7684\u53d8\u5316"),(0,s.kt)("p",null,"\u7c7b\u56fe\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-mermaid"},"classDiagram\nContext --\x3e State\nclass State {\n  - color:String\n  +handle(context)\n}\n\nclass Context {\n  - state\n  +getState() State\n  +setState(state)\n}\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"// \u72b6\u6001\uff08\u7ea2\u9ec4\u7eff\uff09\nclass State {\n  constructor(color) {\n    this.color = color\n  }\n  handle(context) {\n    console.log(`turn to ${this.color} light`)\n    context.setState(this)\n  }\n}\n\nclass Context {\n  constructor() {\n    this.state = null\n  }\n  getState() {\n    return this.state\n  }\n  setState(state) {\n    this.state = state \n  }\n}\n\nconst context = new Context()\nconst red = new State('red')\nconst green = new State('green')\nconst yellow = new State('yellow')\n// \u7eff\u706f\u4eae\ngreen.handle(context)\nconsole.log(context.getState())\n")),(0,s.kt)("h2",{id:"\u5e94\u7528\u573a\u666f"},"\u5e94\u7528\u573a\u666f"),(0,s.kt)("h3",{id:"\u6709\u9650\u72b6\u6001\u673a"},"\u6709\u9650\u72b6\u6001\u673a"),(0,s.kt)("h3",{id:"javascript-state-machine"},"javascript-state-machine"),(0,s.kt)("p",null,"\u6536\u85cf - \u53d6\u6d88\u6536\u85cf"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-html"},"<button id=\"btn\"> \u2764 </button>\n<script>\nimport StateMachine from 'javascript-state-machine'\n\nconst btn = document.getElementById('btn');\n\nconst fsm = StateMachine({\n  init: '\u672a\u6536\u85cf',\n  transitions: [\n    {\n      name: 'doStore',\n      from: '\u672a\u6536\u85cf',\n      to: '\u5df2\u6536\u85cf'\n    },\n    {\n      name: 'deleteStore',\n      from: '\u5df2\u6536\u85cf'\uff0c\n      to: '\u672a\u6536\u85cf'\n    }\n  ],\n  methods: {\n    // \u6536\u85cf\n    onDoStore: function(){\n      console.log('\u6536\u85cf\u6210\u529f')\n      updateText()\n    },\n    // \u53d6\u6d88\u6536\u85cf\n    onDeleteStore: function() {\n      console.log('\u53d6\u6d88\u6536\u85cf')\n      updateText()\n    }\n  }\n})\n\nbtn.addEventListener('click', () => {\n  if (fsm.is('\u672a\u6536\u85cf')) {\n     fsm.doStore()\n  } else {\n    fsm.deleteStore()\n  }\n})\n\nfunction updateText() {\n  btn.innerText = fsm.state\n}\n\nupdateText()\n<\/script>\n")),(0,s.kt)("h3",{id:"\u624b\u5199\u7b80\u964b-promise"},"\u624b\u5199\u7b80\u964b Promise"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"import StateMachine from 'javascript-state-machine'\n\nclass MyPromise {\n  constructor(fn) {\n    this.fsm = new StateMachine({\n      init: 'pending',\n      transitions: [\n        {\n          name: 'resolve',\n          from: 'pending',\n          to: 'fullfilled'\n        },\n        {\n          name: 'reject',\n          from: 'pending',\n          to: 'rejected'\n        }\n      ],\n      methods: {\n        onResolve: function(state, data) {\n          data.successList.forEach(fn => fn())\n        }, \n        onReject: function(state, data) {\n          data.failList.forEach(fn => fn())\n        }\n      }\n    })\n    this.successList = [];\n    this.failList = []\n\n    fn(() => {\n      fsm.resolve(this)\n    }, () => {\n      fsm.reject(this)\n    })\n  }\n\n  then(successFn, failFn) {\n    this.successList.push(successFn)\n    this.failList.push(failFn)\n  }\n}\n\nexport default MyPromise\n")),(0,s.kt)("h2",{id:"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1"},"\u8bbe\u8ba1\u539f\u5219\u9a8c\u8bc1"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u5c06\u72b6\u6001\u5bf9\u8c61\u548c\u4e3b\u9898\u5bf9\u8c61\u5206\u79bb\uff0c\u72b6\u6001\u7684\u53d8\u5316\u903b\u8f91\u5355\u72ec\u5904\u7406"),(0,s.kt)("li",{parentName:"ul"},"\u7b26\u5408\u5f00\u653e\u5c01\u95ed\u539f\u5219")))}g.isMDXComponent=!0}}]);
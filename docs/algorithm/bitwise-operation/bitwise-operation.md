---
id: bitwise-operation
title: 位运算
tags:
  - 位运算
---

## 逻辑位运算符

### & 位与

两个位都为 1 时，结果才为 1

### | 位或

两个位都为 0 时，结果才为 0

### ^ 异或

两个位相同为 0，相异为 1

### ~ 按位取反

0 => 1, 1 => 0

## 位移运算符

### << 左移

所有二进位都左移若干位，高位丢弃，低位补 0
x << 1, 相当于乘 2

### >> 右移

所有二进制都右移若干位，无符号数高位补 0，有符号数各编译器处理不同

x >> 1, 相当于除以 2，向下取整

## 常见应用

- 判断奇偶 x & 1
  - 0 => 偶数
  - 1 => 奇数

## 热身小练习

### 不用加减乘除 - 加法

对于二进制加法：

- 本位 => 异或 ^
  - 0 + 0 = 0 加数相同为 0
  - 1 + 1 = 0 加数相同为 0
  - 1 + 0 = 1 加数不同为 1
  - 0 + 1 = 1 加数不同为 1
- 进位 => 与 &
  - 1 + 1 = 1 加数都为 1，才进位
  - 1 + 0 = 0 无进位
  - 0 + 1 = 0 无进位
  - 0 + 0 = 0 无进位

举例 26 + 35

十进制的时候，我们计算是类似这样的过程

```js
    26
 +  35
 -----
    11
    5
 -----
    61
```

如果用本位/进位的方式处理一下就是

```js
    26
 +  35
 -----
    51 // 本位
    01 // 进位
```

这里的 01 是计算后的进位，需要做进位逻辑处理进入下轮计算，即乘以进制数 `01 * 10 = 10`

```js
    51
 +  10
 -----
    61
```

二进制的话也同理用本位/进位的方式处理一下就是

本位： `a ^ b`
进位： `a & b`
进位逻辑：乘以进制数就是乘以 2，相当于左移 => `(a & b) << 1`
最后没有进位时即，进位 为 0 时，返回本位

```js
/**
 * @param {number} a
 * @param {number} b
 * @return {number}
 */
var add = function(a, b) {
  while(b !== 0) {
      const carry = (a & b) << 1
      a = a ^ b
      b = carry
  }
  return a
};
```
